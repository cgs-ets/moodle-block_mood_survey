define ("block_mood_survey/controls",["jquery","core/log","core/ajax"],function(a,b,c){'use strict';function d(a,b,c){var d=this;d.region=a;d.instanceid=b;d.isstudent=c}d.prototype.main=function(){var b=this;b.region.on("click",".answer .option",function(c){c.preventDefault();var d=a(this);b.saveSurveyResponse(d)});b.region.on("click",".survey-more",function(){a("#answersbody").css("text-align","justify");a("#answersbody").find("a").removeAttr("data-original-title");a("#answersbody").find("span").css("display","inline");a("#answersbody").find(".help").css("display","inline");this.text="Less...";a(this).addClass("survey-less");a(this).removeClass("survey-more");return!1});b.region.on("click",".survey-less",function(){a("#answersbody").css("text-align","center");a("#answersbody").find(".help").css("display","none");a("#answersbody").find("span").css("display","none");a("#answersbody").children().each(function(){a(this).attr("data-original-title",a(this).first().text())});this.text="More...";a(this).removeClass("survey-less");a(this).addClass("survey-more");document.getElementById("question").scrollIntoView();return!1});b.region.on("click",".survey-opt-out",function(a){a.preventDefault();b.saveOptOut()})};d.prototype.saveOptOut=function(){var a=this;c.call([{methodname:"block_mood_survey_save_opt_out",args:{},done:function done(c){a.region.find(".survey").html("<h3>Thank you</h3>");a.region.delay(2e3).fadeOut(400);b.debug(c)},fail:function fail(a){b.error(a)}}])};d.prototype.saveSurveyResponse=function(d){var e=this;if(e.region.hasClass("submitting")){return}var f=d.closest(".question"),g=f.data("id"),h=f.data("title"),i=d.data("value");a("body").find(".tooltip").css("display","none");if(null===g||null===h||null===i){return}e.region.addClass("submitting");f.addClass("submitting");d.addClass("submitting");c.call([{methodname:"block_mood_survey_save_survey_response",args:{questionid:g,questiontitle:h,response:i},done:function done(a){if(a.completed){e.region.find(".survey").html(a.message);e.region.delay(2e3).fadeOut(400)}},fail:function fail(a){e.region.find(".survey").html("<h3>Error: Failed to save survey response.</h3>");b.error(a)}}])};return{init:function(c,e){b.debug("block_mood_survey/control: initializing controls of the block_mood_survey block instance "+c);var f=a("[data-region=\"block_mood_survey-instance-"+c+"\"]").first();if(!f.length){b.debug("block_mood_survey/control: wrapping region not found!");return}var g=new d(f,c,e);g.main()}}});
//# sourceMappingURL=controls.min.js.map
